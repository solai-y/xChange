<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="images/logo.jpeg" type="image/x-icon">
  <title>Module Mapping</title>


  <!-- update the version number as needed -->
  <script defer src="/__/firebase/10.4.0/firebase-app-compat.js"></script>
  <!-- include only the Firebase features as you need -->
  <script defer src="/__/firebase/10.4.0/firebase-auth-compat.js"></script>
  <script defer src="/__/firebase/10.4.0/firebase-database-compat.js"></script>
  <script defer src="/__/firebase/10.4.0/firebase-firestore-compat.js"></script>
  <script defer src="/__/firebase/10.4.0/firebase-functions-compat.js"></script>
  <script defer src="/__/firebase/10.4.0/firebase-messaging-compat.js"></script>
  <script defer src="/__/firebase/10.4.0/firebase-storage-compat.js"></script>
  <script defer src="/__/firebase/10.4.0/firebase-analytics-compat.js"></script>
  <script defer src="/__/firebase/10.4.0/firebase-remote-config-compat.js"></script>
  <script defer src="/__/firebase/10.4.0/firebase-performance-compat.js"></script>
  <!-- 
        initialize the SDK after all desired features are loaded, set useEmulator to false
        to avoid connecting the SDK to running emulators.
      -->
  <script defer src="/__/firebase/init.js?useEmulator=true"></script>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3/dist/css/bootstrap.min.css" rel="stylesheet"> 
  <link rel="stylesheet" href="stylesheets/style.css">
  <link rel="stylesheet" href="stylesheets/modulemapping.css">
  <!-- Vue 3 -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  
</head>
<body>
        <!-- BS navbar: start -->
        <nav class="navbar navbar-expand-lg">
          <div class="container-fluid">
              <a class="navbar-brand" href="./index.html"><img src="./images/logo.jpeg" class="logo" /></a>
              <button
                  class="navbar-toggler"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#navbarSupportedContent"
                  aria-controls="navbarSupportedContent"
                  aria-expanded="false"
                  aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                  <ul class="navbar-nav me-auto mb-2 mb-lg-0" id="navbarList">
                      <li class="nav-item">
                          <a class="nav-link active" aria-current="page" href="./university.html">Home</a>
                      </li>

                      <li class="nav-item">
                          <a class="nav-link active" href="./forum.html">Forum</a>
                      </li>
                      <li class="nav-item">
                          <a class="nav-link active " href="./modulemapping.html">Module Mapping</a>
                      </li>
                  </ul>
                  <ul class="navbar-nav me-end mb-2 mb-lg-0" >
                    <li class="nav-item" >
                      <a class="nav-link active" onclick="logout()"><label id="logout_header">Log out</label></a>
                    </li>
                </ul>
                  <div class="navimage d-flex align-items-center" id="signUpLogInImage">
                      <!-- <a href="./account.html" class="avatar rounded-circle text-white d-none d-lg-flex">
                          <img id="userImage" class="profilepicture" alt="imageInput1" src="./images/profile photo.jpeg" />
                      </a> -->
                  </div>
              </div>
          </div>
      </nav> 
      <script>
        const navbar = document.querySelector('.navbar');

        // Add an event listener to the navbar when it shows
        navbar.addEventListener('show.bs.collapse', function () {
            const dropdown = this.querySelector('.navbar-collapse');
            if (dropdown) {
                dropdown.classList.add('custom-dropdown-bg');
            }
            numOfLi = document.getElementsByClassName("nav-item");
            if (numOfLi.length < 4) {
              let li  = document.createElement("li");
              let a = document.createElement("a");
              let liTn = document.createTextNode("Profile");
              a.appendChild(liTn);
              a.setAttribute("href", "./account.html")
              li.setAttribute("class", "nav-item");
              li.appendChild(a);
              a.style.color = "black";
              document.getElementById("navbarList").appendChild(li);
            }
            
        });

        // Remove the custom class when the dropdown is hidden
        navbar.addEventListener('hide.bs.collapse', function () {
            const dropdown = this.querySelector('.navbar-collapse');
            if (dropdown) {
                dropdown.classList.remove('custom-dropdown-bg');
            }
        });

      </script>
    
    <div id="appVue">
      <!-- Basket Selection Section -->
      <div class="container-fluid" v-if="!search">
        <h1 class="text-center">
          What baskets do you need to clear on exchange?
        </h1>
        <div class="inputBox">
          <div class="card-container">
            <div class="checkbox-row" v-for="(module, backendName) in moduleList">
              <label class="checkbox-box">
                <input type="checkbox" :value="backendName" :id="module" v-model="selectedModuleNames">
                <div>
                  {{module}}
                </div>
              </label>
            </div>
          </div>
          <div class="py-2 text-end">
            <button id="primaryButton" value="search" @click="btnSearchClick()">Search</button>
          </div>
        </div>
      </div>
      <!-- Results Section-->
      <div class="results" v-else>
        <div class="container py-3" id="resultsSection">
          <!-- Start of Search engine-->
          <div class="container text-center">
            <div class="row">
              <div class="col-lg-6 col-md-8 mx-auto">
                <div class="head">
                  <div class="title">
                    <h1 class="text">
                      Search By Desired University or Country
                    </h1>
                  </div>
                </div>
                  <p>
                    <div class="inputBox">
                      <input class="text" type="search" data-search-country-name v-model="btnSearchCountry" id="searchCountryName">
                      <div id="suggestionListCountryName"></div>
                      <span>Country</span>
                    </div> 
                    <br>
                    <div class="inputBox">
                      <input class="text" type="search" data-search-uni-name v-model="btnSearch" id="searchUniName">
                      <div id="suggestionListUniName"></div>
                      <span>University</span>
                    </div> 
                    <br>
                    <div class="div">
                      <button class="searchOption" style="margin-right: 10px;">
                        <a href="#scrollSearch" id="searchTab">
                          Search
                        </a>
                      </button>
                      <button @click="btnEditSearch()"  class="searchOption">Back</button>     
                    </div>
                  </p>
              </div>
            </div>
          </div>
          <!-- End of Search engine-->
        </div>
          <!-- Start of Results display -->
          <div id="scrollSearch"></div>
          <div class="album bg-light">
            <div class="container">
              <div class="row" v-for="uni in filteredUniList">
                <a :href="'./individualunipage.html?uni=' + uni[1]" :id="uni[1]" class="uniNames" v-if="shouldShowUni(uni)">
                  <div class="card cardcss">
                    <img :src="uni[0].gallery[0]" :alt="uni[0].name">                    
                    <div class="card-body">
                      <div class="text-section">
                        <h3 class="card-title">{{uni[0].name}}</h3>
                        <p class="card-text">
                          <ul class="list-group list-group-flush">
                            <li class="list-group-item" v-for="selectedModule in selectedModuleNames">
                              <h6>For {{selectedModule.slice(7).split(/(?=[A-Z])/).map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ')}} you can take these mods:</h6>
                              <ul>
                                <li class="modList" v-for="mod in uni[0][selectedModule]">{{mod}}</li>
                              </ul>
                              <!-- <span class="modName" v-for="mod in uni[0][selectedModule]">{{mod}} <br></span> -->
                            </li>
                          </ul>
                        </p>  
                      </div>
                    </div>
                  </div>
                </a>
              </div>
            </div>
          </div>
          <!-- End of Result display -->
      </div>
    </div>
    <!-- Site footer -->
    <footer class="footer">
      <div class="container">
          <div class="row">
              <div class="col-md-3">
                  <h6>
                      <img src="./images/logo.jpeg" id="header-photo" />
                  </h6>
                  <p class="text-justify">
                      xChange aims to be a one stop platform for students to plan for their exchange with
                      ease.
                  </p>
              </div>
              <div class="col-md-3">
                  <h6>Socials</h6>
                  <ul class="socials">
                      <li>
                          <a class="facebook" href="#"
                              ><label for="facebook"
                                  ><svg
                                      xmlns="http://www.w3.org/2000/svg"
                                      width="20"
                                      height="20"
                                      fill="currentColor"
                                      class="bi bi-facebook"
                                      viewBox="0 0 16 16">
                                      <path
                                          d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z" /></svg></label
                          ></a>
                      </li>
                      <li>
                          <a class="x" href="#"
                              ><label for="facebook"
                                  ><svg
                                      xmlns="http://www.w3.org/2000/svg"
                                      width="20"
                                      height="20"
                                      fill="currentColor"
                                      class="bi bi-twitter-x"
                                      viewBox="0 0 16 16">
                                      <path
                                          d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865l8.875 11.633Z" /></svg></label
                          ></a>
                      </li>
                      <li>
                          <a class="linkedin" href="#"
                              ><label for="facebook"
                                  ><svg
                                      xmlns="http://www.w3.org/2000/svg"
                                      width="20"
                                      height="20"
                                      fill="currentColor"
                                      class="bi bi-linkedin"
                                      viewBox="0 0 16 16">
                                      <path
                                          d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z" /></svg></label
                          ></a>
                      </li>
                  </ul>
              </div>

              <div class="col-md-3">
                  <h6>Quick Links</h6>
                  <ul class="footer-links">
                      <li>
                          <a href="./university.html"><label>Home</label></a>
                      </li>
                      <li>
                          <a href="./forum.html"><label>Forum</label></a>
                      </li>
                      <li>
                        <a href="./modulemapping.html"><label>Module Mapping</label></a>
                      </li>
                      <li>
                          <a href="./account.html"><label>Profile</label></a>
                      </li>
                  </ul>
              </div>

              <div class="col-md-3">
                <h6>Account</h6>
                <ul class="footer-links">
                    <li id="login_footer">
                        <a href="./login_page.html"><label>Log In</label></a>
                    </li>
                    <li id="register_footer">
                        <a href="./login_page.html"><label>Register</label></a>
                    </li>
                    <li id="logout_footer">
                        <a onclick="logout()"><label>Log Out</label></a>
                    </li>
                </ul>
            </div>
          </div>
      </div>

      <hr />
      <div class="container">
          <div class="row">
              <div class="text-center">
                  <p class="copyright-text">
                      Copyright &copy; 2023 All Rights Reserved by <a href="#"><label>xChange</label></a
                      >.
                  </p>
              </div>
          </div>
      </div>
    </footer>

    <script>
          var data = ""

          data = JSON.parse(sessionStorage.getItem("user"));
          if(data==null){
        document.getElementById("login_footer").hidden= false;
        document.getElementById("logout_footer").hidden= true;
        document.getElementById("logout_header").hidden= true;
        document.getElementById("register_footer").hidden= false;
    }else{
        document.getElementById("login_footer").hidden= true;
        document.getElementById("logout_footer").hidden= false;
        document.getElementById("logout_header").hidden= false;
        document.getElementById("register_footer").hidden= true;
    }

    function logout() {
        // Sign out from Firebase
        firebase.auth().signOut()
            .then(() => {
                // Clear the session storage
                sessionStorage.clear();

                // Implement your logout logic here, such as redirecting
                location.href = "index.html"; // Replace with your desired action
            })
            .catch(error => {
                console.error("Error during sign-out:", error);
            });
    }


          console.log(data);
          var emailadd = data.email;
          var emailInput = document.getElementById("email");
          emailInput.value = emailadd;
    </script>


  <!-- Bootstrap JS bundle to be placed before the closing </body> tag -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3/dist/js/bootstrap.bundle.min.js" ></script> 
  <script src="./modulemapping.js"></script>
</body>
</html>